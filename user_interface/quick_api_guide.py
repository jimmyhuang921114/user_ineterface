#!/usr/bin/env python3 """ API -  Quick API Usage Guide """ import requests import json # API API_BASE = "http://localhost:8000" # === 1.  === def get_medicine_info(medicine_name): """""" response = requests.get(f"{API_BASE}/api/medicine/detailed/{medicine_name}") return response.json() if response.status_code == 200 else None # === 2.  === def find_medicine_by_code(code): """""" response = requests.get(f"{API_BASE}/api/medicine/search/code/{code}") return response.json() if response.status_code == 200 else None # === 3.  === def get_patient_info(patient_id): """""" response = requests.get(f"{API_BASE}/api/patients/{patient_id}") return response.json() if response.status_code == 200 else None # === 4.  === def get_patient_records(patient_id): """""" response = requests.get(f"{API_BASE}/api/records/patient/{patient_id}") return response.json() if response.status_code == 200 else [] # === 5. + === def get_complete_medicine_info(medicine_name): """+""" response = requests.get(f"{API_BASE}/api/medicine/integrated/{medicine_name}") return response.json() if response.status_code == 200 else None # === 6. JSON === def export_data(data_type="complete"): """JSON data_type: 'medicines', 'patients', 'records', 'complete' """ endpoints = { 'medicines': '/api/export/medicines/integrated', 'patients': '/api/export/patients', 'records': '/api/export/records', 'complete': '/api/export/complete' } url = f"{API_BASE}{endpoints.get(data_type, endpoints['complete'])}" response = requests.get(url) return response.json() if response.status_code == 200 else None # ===  === if __name__ == "__main__": print("API - ") print("=" * 40) # 1.  print("1. :") heart_med = get_medicine_info("") if heart_med: print(f" : {heart_med.get('', {}).get('')}") print(f" : {heart_med.get('', {}).get('')}") # 2.  print("\n2. 202801:") code_result = find_medicine_by_code("202801") if code_result: for name in code_result.keys(): print(f" : {name}") # 3.  print("\n3. :") complete_info = get_complete_medicine_info("") if complete_info: print(f" : {complete_info.get('status')}") if complete_info.get('basic_info'): print(f" : {complete_info['basic_info']['amount']}") # 4.  print("\n4. :") medicines_data = export_data('medicines') if medicines_data: print(f"  {medicines_data.get('total_count')} ") #  with open('my_medicines.json', 'w', encoding='utf-8') as f: json.dump(medicines_data, f, ensure_ascii=False, indent=2) print("  my_medicines.json") print("\n") # ===  === def quick_medicine_lookup(name_or_code): """""" #  result = get_medicine_info(name_or_code) if result: return {"type": "name", "data": result} #  result = find_medicine_by_code(name_or_code) if result: return {"type": "code", "data": result} return None def get_patient_complete_info(patient_id): """+""" patient = get_patient_info(patient_id) if not patient: return None records = get_patient_records(patient_id) return { "patient": patient, "records": records, "total_visits": len(records) }