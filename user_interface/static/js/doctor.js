document.addEventListener("DOMContentLoaded", () => { const container = document.getElementById("excelTable"); const hot = new Handsontable(container, { // data: [ // ["Paracetamol", "500mg", "3x/day", "", ""], // ["Ibuprofen", "200mg", "2x/day", "", ""], // ["Paracetamol", "30tablets", "3x/day", "", ""], // ], colHeaders: ["", "", "", "", ""], columns: [ { type: 'text' }, { type: 'text' }, { type: 'text' }, { type: 'text' }, { type: 'text' } ], rowHeaders: true, minSpareRows: 1, stretchH: 'all', height: 300, licenseKey: 'non-commercial-and-evaluation' }); document.getElementById("prescriptionForm").addEventListener("submit", function (e) { e.preventDefault(); const name = document.getElementById("PatientName").value.trim(); const id = document.getElementById("id_number").value.trim(); const sex = document.querySelector('input[name="sex"]:checked')?.value || "Unknown"; const prescription = hot.getData().filter(row => row.some(cell => cell !== null && cell.toString().trim() !== "") ); if (!name || !id || prescription.length === 0) { alert(""); return; } const patient = { name, id, sex, created_at: new Date().toLocaleString(), prescription, picked_state: "", collected_state: "" }; console.log("Submitted Patient:", patient); alert("\n console "); //  this.reset(); hot.loadData([ ["", "", "", "", ""] ]); }); });