# é†«é™¢è—¥ç‰©ç®¡ç†ç³»çµ±

é€™æ˜¯ä¸€å€‹å®Œæ•´çš„é†«é™¢è—¥ç‰©ç®¡ç†ç³»çµ±ï¼Œæ”¯æ´å‰å¾Œç«¯é€£æ¥ã€è³‡æ–™å„²å­˜ã€ä»¥åŠJSONæ ¼å¼çš„è³‡æ–™æŸ¥è©¢å’Œå°å‡ºåŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹è‰²

### æ ¸å¿ƒåŠŸèƒ½
- **è—¥ç‰©åº«å­˜ç®¡ç†**: æ–°å¢ã€æŸ¥çœ‹ã€ç·¨è¼¯ã€åˆªé™¤è—¥ç‰©è³‡è¨Š
- **è©³ç´°è—¥ç‰©è³‡æ–™**: æ”¯æ´è—¥ç‰©è©³ç´°è³‡è¨Šç®¡ç†
- **æ‚£è€…ç®¡ç†**: æ‚£è€…è³‡æ–™ç®¡ç†èˆ‡è¨˜éŒ„
- **è™•æ–¹ç®¡ç†**: è™•æ–¹å»ºç«‹èˆ‡ç‹€æ…‹è¿½è¹¤
- **å³æ™‚è³‡æ–™åŒæ­¥**: å‰ç«¯æ“ä½œå³æ™‚åŒæ­¥åˆ°å¾Œç«¯è³‡æ–™åº«
- **æœå°‹åŠŸèƒ½**: æ”¯æ´è—¥åæ¨¡ç³Šæœå°‹
- **JSONå°å‡º**: ä¸€éµå°å‡ºå®Œæ•´è—¥ç‰©è³‡æ–™ç‚ºJSONæ ¼å¼

### è—¥ç‰©è³‡è¨Šæ¬„ä½
- **è—¥å“åç¨±**: è—¥ç‰©çš„æ­£å¼åç¨±
- **è—¥ç‰©æ•¸é‡**: åº«å­˜æ•¸é‡
- **ä½¿ç”¨å¤©æ•¸**: è—¥ç‰©çš„å»ºè­°ä½¿ç”¨æœŸé™
- **è—¥ç‰©ä½ç½®**: å„²å­˜ä½ç½®ï¼ˆå¦‚ A1-01ï¼‰
- **å»ºç«‹æ™‚é–“**: è‡ªå‹•è¨˜éŒ„è³‡æ–™å»ºç«‹æ™‚é–“

## ç³»çµ±æ¶æ§‹

```
é†«é™¢è—¥ç‰©ç®¡ç†ç³»çµ±/
â”œâ”€â”€ fixed_server.py          # ä¸»è¦ä¼ºæœå™¨æ–‡ä»¶
â”œâ”€â”€ start_server.py          # å•Ÿå‹•è…³æœ¬
â”œâ”€â”€ static/                  # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ html/               # HTMLé é¢
â”‚   â”‚   â”œâ”€â”€ Medicine.html   # è—¥ç‰©ç®¡ç†é é¢
â”‚   â”‚   â”œâ”€â”€ doctor.html     # é†«ç”Ÿç®¡ç†é é¢
â”‚   â”‚   â””â”€â”€ Prescription.html # è™•æ–¹ç®¡ç†é é¢
â”‚   â””â”€â”€ css/                # æ¨£å¼æ–‡ä»¶
â”‚       â””â”€â”€ unified_style.css # çµ±ä¸€æ¨£å¼è¡¨
â””â”€â”€ README.md               # èªªæ˜æ–‡ä»¶
```

## å®‰è£èˆ‡é‹è¡Œ

### 1. å®‰è£ä¾è³´
```bash
pip install fastapi uvicorn
```

### 2. å•Ÿå‹•ä¼ºæœå™¨
```bash
# æ–¹æ³•ä¸€ï¼šä½¿ç”¨å•Ÿå‹•è…³æœ¬
python3 start_server.py

# æ–¹æ³•äºŒï¼šç›´æ¥å•Ÿå‹•
python3 -m uvicorn fixed_server:app --host 0.0.0.0 --port 8000 --reload
```

### 3. è¨ªå•ç³»çµ±
- **ç¶²é ç•Œé¢**: http://localhost:8000/Medicine.html
- **APIæ–‡æª”**: http://localhost:8000/docs
- **æ ¹ç›®éŒ„**: http://localhost:8000/

## API ç«¯é»

### è—¥ç‰©ç®¡ç†
- `GET /api/medicine/` - ç²å–æ‰€æœ‰è—¥ç‰©
- `POST /api/medicine/` - æ–°å¢è—¥ç‰©
- `PUT /api/medicine/{id}` - æ›´æ–°è—¥ç‰©è³‡è¨Š
- `DELETE /api/medicine/{id}` - åˆªé™¤è—¥ç‰©

### è©³ç´°è—¥ç‰©ç®¡ç†
- `GET /api/medicine/detailed/` - ç²å–æ‰€æœ‰è©³ç´°è—¥ç‰©è³‡æ–™
- `POST /api/medicine/detailed/` - æ–°å¢è©³ç´°è—¥ç‰©è³‡æ–™
- `GET /api/medicine/search/detailed/{query}` - æœå°‹è©³ç´°è—¥ç‰©
- `GET /api/medicine/search/code/{code}` - æ ¹æ“šä»£ç¢¼æœå°‹è—¥ç‰©

### æ‚£è€…ç®¡ç†
- `GET /api/patients/` - ç²å–æ‰€æœ‰æ‚£è€…
- `POST /api/patients/` - æ–°å¢æ‚£è€…
- `PUT /api/patients/{id}` - æ›´æ–°æ‚£è€…è³‡æ–™
- `DELETE /api/patients/{id}` - åˆªé™¤æ‚£è€…

### æ‚£è€…è¨˜éŒ„
- `GET /api/records/` - ç²å–æ‰€æœ‰è¨˜éŒ„
- `POST /api/records/` - æ–°å¢è¨˜éŒ„
- `GET /api/records/patient/{patient_id}` - ç²å–æ‚£è€…è¨˜éŒ„

### è™•æ–¹ç®¡ç†
- `GET /api/prescription/` - ç²å–æ‰€æœ‰è™•æ–¹
- `POST /api/prescription/` - æ–°å¢è™•æ–¹
- `PUT /api/prescription/{id}/status` - æ›´æ–°è™•æ–¹ç‹€æ…‹

### å°å‡ºåŠŸèƒ½
- `GET /api/export/medicines/basic` - å°å‡ºåŸºæœ¬è—¥ç‰©è³‡æ–™
- `GET /api/export/medicines/detailed` - å°å‡ºè©³ç´°è—¥ç‰©è³‡æ–™
- `GET /api/export/patients` - å°å‡ºæ‚£è€…è³‡æ–™
- `GET /api/export/records` - å°å‡ºæ‚£è€…è¨˜éŒ„
- `GET /api/export/complete` - å°å‡ºå®Œæ•´ç³»çµ±è³‡æ–™

## ä½¿ç”¨æ–¹å¼

### ğŸ–¥ï¸ ç¶²é ç•Œé¢æ“ä½œ

1. **è—¥ç‰©ç®¡ç†é é¢**:
   - æŸ¥çœ‹è—¥ç‰©çµ±è¨ˆè³‡è¨Š
   - è¼‰å…¥å’Œç·¨è¼¯åŸºæœ¬è—¥ç‰©è³‡æ–™
   - æœå°‹è©³ç´°è—¥ç‰©è³‡è¨Š
   - å°å‡ºJSONæ ¼å¼è³‡æ–™

2. **é†«ç”Ÿç®¡ç†é é¢**:
   - æ–°å¢åŸºæœ¬è—¥ç‰©
   - æ–°å¢è©³ç´°è—¥ç‰©è³‡æ–™
   - å»ºç«‹æ‚£è€…è™•æ–¹

3. **è™•æ–¹ç®¡ç†é é¢**:
   - æŸ¥çœ‹è™•æ–¹çµ±è¨ˆ
   - ç¯©é¸è™•æ–¹ç‹€æ…‹
   - æŸ¥çœ‹è™•æ–¹è©³æƒ…
   - æ›´æ–°è™•æ–¹ç‹€æ…‹

### API èª¿ç”¨ç¯„ä¾‹

#### æ–°å¢è—¥ç‰©
```python
import requests

medicine_data = {
    "name": "é˜¿æ–¯åŒ¹éˆ",
    "amount": 100,
    "usage_days": 30,
    "position": "A1-01"
}

response = requests.post("http://localhost:8000/api/medicine/", json=medicine_data)
print(response.json())
```

#### ç²å–æ‰€æœ‰è—¥ç‰©
```python
response = requests.get("http://localhost:8000/api/medicine/")
medicines = response.json()
print(f"å…±æœ‰ {len(medicines)} å€‹è—¥ç‰©")
```

#### å°å‡ºJSONè³‡æ–™
```python
response = requests.get("http://localhost:8000/api/export/complete")
export_data = response.json()

# ä¿å­˜åˆ°æ–‡ä»¶
import json
with open('complete_system_export.json', 'w', encoding='utf-8') as f:
    json.dump(export_data, f, ensure_ascii=False, indent=2)
```

## æŠ€è¡“æ£§

### å¾Œç«¯
- **FastAPI**: ç¾ä»£ã€å¿«é€Ÿçš„Webæ¡†æ¶
- **Uvicorn**: ASGIä¼ºæœå™¨
- **Pydantic**: è³‡æ–™é©—è­‰

### å‰ç«¯
- **HTML5/CSS3**: æ¨™æº–WebæŠ€è¡“
- **JavaScript ES6+**: ç¾ä»£JavaScript
- **Handsontable**: å°ˆæ¥­è¡¨æ ¼çµ„ä»¶
- **Fetch API**: åŸç”ŸHTTPå®¢æˆ¶ç«¯

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **ä¼ºæœå™¨ç„¡æ³•å•Ÿå‹•**
   ```bash
   # æª¢æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   lsof -i :8000
   
   # æ®ºæ­»å ç”¨é€²ç¨‹
   kill -9 <PID>
   ```

2. **å‰ç«¯ç„¡æ³•é€£æ¥å¾Œç«¯**
   - ç¢ºèªä¼ºæœå™¨æ­£åœ¨é‹è¡Œ
   - æª¢æŸ¥é˜²ç«ç‰†è¨­å®š
   - ç¢ºèªAPI URLæ­£ç¢º

3. **ä¾è³´ç¼ºå¤±**
   ```bash
   # é‡æ–°å®‰è£ä¾è³´
   pip install fastapi uvicorn
   ```

## æˆæ¬Šå”è­°

MIT License - è«‹åƒè€ƒLICENSEæ–‡ä»¶äº†è§£è©³ç´°è³‡è¨Šã€‚

---

**ç³»çµ±å·²ä¿®å¾©å®Œæˆï¼**

ç¾åœ¨æ‚¨æ“æœ‰ä¸€å€‹å®Œæ•´çš„é†«é™¢è—¥ç‰©ç®¡ç†ç³»çµ±ï¼Œæ”¯æ´ï¼š
- å‰å¾Œç«¯å®Œæ•´é€£æ¥
- è³‡æ–™å„²å­˜åˆ°å¾Œç«¯è³‡æ–™åº«
- JSONæ ¼å¼è³‡æ–™æŸ¥è©¢å’Œå°å‡º
- ç¾ä»£åŒ–çš„Webç•Œé¢
- å®Œæ•´çš„APIæ–‡æª”

é–‹å§‹ä½¿ç”¨å§ï¼